@page "/"
@inject NavigationManager NavigationManager
<PageTitle>Home</PageTitle>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<link rel="stylesheet" href="/css/Logincss.css"/>

<img src="/fondoo.jpg" alt="Background Image" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; object-fit: cover;">


    <div class="container" id="container">
        <div class="form-container sign-in">
            <EditForm Model="@this" OnValidSubmit="PerformLogin">
                <h1>inicar sesion</h1>
                <InputText id="email" @bind-Value="Email" type="email" placeholder="Correo electrónico" />
                <InputText id="password" @bind-Value="Password" type="password" placeholder="Contraseña" />
                <button type="submit">Iniciar sesion</button>
            </EditForm>
        </div>
        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-right">
                    <img src="/login2.jpg" alt="Image" class="imagenlogologin" />
                    <h1>Bienvenido!</h1>
                    <p>Registrate apretando aqui abajo!</p>
                    <button class="hidden" id="register" @onclick="registro">REGISTRARSE</button>
                </div>
            </div>
        </div>
    </div>

@code {
   string Email = "";
    string Password = "";

[Inject]
public IJSRuntime JSRuntime { get; set; }

async Task PerformLogin()
{
    try {
        var userId = await JSRuntime.InvokeAsync<string>("loginUser", Email, Password);
        if (userId != null) {
            await JSRuntime.InvokeVoidAsync("alertaLogin", "Inicio de sesión exitoso!"); // Llama a la función de alerta
            NavigationManager.NavigateTo("/home");
            Console.WriteLine($"User ID: {userId}");
        } else {
            await JSRuntime.InvokeVoidAsync("alertaError", "Inicio de sesión fallido"); // Llama a la función de alerta
        }
    } catch (Exception exception) {
        // Manejar errores
        await JSRuntime.InvokeVoidAsync("alertaError", "Inicio de sesión fallido"); // Llama a la función de alerta con el mensaje de error
    }
}

private void registro()
{
    NavigationManager.NavigateTo("/registro");
}
}