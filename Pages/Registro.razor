@page "/registro"
@inject NavigationManager NavigationManager
<PageTitle>Registro</PageTitle>
<script href></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<link rel="stylesheet" href="/css/Logincss.css"/>

<img src="/fondoo.jpg" alt="Background Image" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; object-fit: cover;">

{
    <div class="container" id="container">
        
        <div class="form-container sign-in">
            <EditForm Model="@this" OnValidSubmit="SaveData">
                <NavLink href="/">⬅️ Regresar</NavLink>
                <h1>Registro</h1>
                <InputText id="nombre" @bind-Value="nombre" placeholder="nombre" />
                <InputText id="telefono" @bind-Value="telefono" placeholder="telefono" />
                <InputText id="email" @bind-Value="direccion" placeholder="direccion" />
                <InputText id="email" @bind-Value="email" placeholder="email" />
                <InputText id="password" @bind-Value="password" type="password" placeholder="Contraseña" />
                <button type="submit">Registrar</button>
            </EditForm>
        </div>
        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-right">
                    <img src="/login2.jpg" alt="Image" class="imagenlogologin" />
                </div>
            </div>
        </div>
    </div>
}
   @code {
    string nombre = "";
    string direccion = "";
    string telefono = "";
    string email = "";
    string password = "";

    [Inject]
    public IJSRuntime JSRuntime { get; set; }

    async Task SaveData()
    {
        try {
            var userId = await JSRuntime.InvokeAsync<string>("registerUser", email, password);
            await JSRuntime.InvokeVoidAsync("saveAdditionalData", userId, nombre, direccion, telefono, email,password);
            if (userId != null) {
                await JSRuntime.InvokeVoidAsync("alertaSucces", "Usuario registrado con éxito!"); // Llama a la función de alerta
                 NavigationManager.NavigateTo("/");
            }else{
                await JSRuntime.InvokeVoidAsync("alertaError", "Usuario NO registrado con éxito"); // Llama a la función de alerta
            }
        } catch (Exception Exception) {
            // Manejar errores
            
        }
    }
}